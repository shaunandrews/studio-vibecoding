# Generic Card Actions & Scroll Fix — February 17, 2026

## Summary

Moved design brief selection from message cards to the input area, using a generic card action system that lets callers provide arbitrary styles and HTML content. Fixed auto-scroll when the input area changes height.

## Generic Card Actions

### Problem

Design brief options were shown in two places: visual cards in the message stream (DesignBriefPickerCard) and text-label buttons in the input area. This split attention and broke the convention of keeping all interactions in the input area.

The first attempt added brief-specific fields to ActionButton (`visual`, then `surface`, `colors`, `description`). InputChat had bespoke rendering code for design briefs—wrong approach. The input system shouldn't know about briefs.

### Solution

`ActionButton` gained a single generic `card` field:

```typescript
card?: {
  style: Record<string, string>  // inline styles on the button
  content: string                // HTML content via v-html
}
```

InputChat is completely dumb about card content. It provides:
- A clickable `<button>` container with the caller's styles applied
- Flex column layout, border-radius, hover/active scale
- Number badge overlay for keyboard shortcuts
- Staggered entrance animation (60ms delay per card)

All visual content—fonts, colors, swatches, typography—is the caller's responsibility via the `content` HTML string and `style` object.

### How useBuildProgress uses it

Builds the brief preview HTML inline:
- Style name as uppercase label
- Site name in the brief's heading font + accent color
- Color swatches as styled spans
- Container styled with the brief's bg/text colors

Font loading happens in useBuildProgress, not InputChat.

### Brief selection flow (updated)

1. Briefs generate → `useBuildProgress` builds HTML card content for each
2. Pushes card actions to the input area via `pushActions()`
3. User clicks a card → `handleAction()` in AgentPanel → `selectBrief()`
4. Actions clear, chosen brief posted as a `DesignBriefPickerCard` in chat history
5. Build continues

No more DesignBriefPickerCard in the message stream during selection.

## Scroll Fix

### Problem

When card actions appear in the input area, the input grows taller. The message list container shrinks (it's flex-1), but scroll position doesn't update—latest messages get hidden behind the taller input.

### Fix

Added a `ResizeObserver` on the scroll container in `ChatMessageList`. When the container resizes (input area grows or shrinks), it triggers `scrollToBottom()`. Properly cleaned up on unmount.

## Files Changed

- `src/data/types.ts` — Added `card?: { style, content }` to ActionButton, removed brief-specific fields
- `src/components/composites/InputChat.vue` — Generic card action rendering (v-html + inline styles), removed all brief-specific code
- `src/data/useBuildProgress.ts` — Builds brief HTML/styles for card actions, font loading, posts chosen brief on selection
- `src/components/composites/ChatMessageList.vue` — ResizeObserver for scroll-to-bottom on container resize
